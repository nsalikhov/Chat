@{
	ViewBag.Title = "Chat";
}

<style>
	.chat-messages
	{
		margin: 30px 0;
		height: 500px;
		overflow: auto;
	}
</style>

<div class="chat-messages">
	<table id="messages-table" class="table table-striped"></table>
</div>

<div class="input-group">
	<input type="text" class="form-control" id="msgText" placeholder="Input message text"/>
	<span class="input-group-btn">
		<button id="sendMsg" class="btn btn-primary">Send message</button>
	</span>
</div>

@section scripts
{
	<script type="text/javascript">
		$(function() {
			var socket = new WebSocket("ws://localhost/SimpleChat/Chat/Sync");

			socket.onmessage = function(msg) {
				$("#messages-table").append("<tr><td>" + msg.data + "</td></tr>");
			};

			socket.onclose = function() {
				alert("Socket connection closed.");
			};

			$("#sendMsg")
				.click(function() {
					var msgText = $("#msgText");

					socket.send(JSON.stringify({ type: "Public", text: msgText.val() }));

					$(msgText).val("");
				});
		});
	</script>
}